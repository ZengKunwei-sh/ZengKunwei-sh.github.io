# 学习强国积分自动化
<img src="/images/2022-3-19-学习强国积分自动化/学习强国主页.png" width="700" height="260"/>
 
## 背景介绍
&emsp;“学习强国”学习平台是由中共中央宣传部主管，以习近平新时代中国特色社会主义思想和党的十九大精神为主要内容，立足全体党员、面向全社会的优质平台[^note]。
对笔者而言，“学习强国”同样是适合获取国家官方信息、了解当今时事、学习医疗健康等各类科普知识的好平台。

&emsp;部分党员对需要每日登录平台、阅读文章而获取的积分有所需求，但常常不小心遗忘或因繁忙而没有时间取得积分。

&emsp;笔者希望能通过python的selenium库实现模拟浏览器操作而自动获取平台积分的功能。

<img src="/images/2022-3-19-学习强国积分自动化/积分.png" width="500" height="250"/>

## 预期目标功能
- 模拟账户登录
- 阅读文章
- 观看视频
- 自动答题并保证正确率
- 运行结束后将结果记录在日志中
## 模拟账户登录
&emsp;学习强国的网页版需要使用手机扫描二维码登录账户。由此我们可以在手动登录账户后获取页面cookies，将cookies保存为本地json文件，使得之后都可以免去登录步骤。

<img src="/images/2022-3-19-学习强国积分自动化/登录.png" width="300" height="150"/>

### 手动登录并获取cookies
```
from selenium import webdriver
import time

browser = webdriver.Chrome()
browser.get('https://pc.xuexi.cn/points/login.html')
browser.maximize_window()                                               # 窗口最大化
browser.execute_script("var q=document.documentElement.scrollTop=1300") # 滑动滚动条至距离顶部1300的位置

time.sleep(20)                                                          # 设置等待时间，利用该时间手机扫码登录账户
```
### 将cookies存储为文本文件
```
with open('cookies.txt', 'w') as f:
    f.write(str(cookies))
```
### 读取cookies
```
with open('cookies.txt', 'r') as f:
    cookies = eval(f.read())                                # 把字符串转化为字典列表
```
### 使用cookies登录页面
```
from selenium import webdriver
    
browser = webdriver.Chrome()
browser.get('https://pc.xuexi.cn/points/my-study.html')

for cookie in cookies:                                      # 输入cookies
        browser.add_cookie(cookie) 
        
browser.get('https://pc.xuexi.cn/points/my-study.html')     # 登录学习主页
```
## 自动答题
### 进入答题页面
```
browser.get('https://pc.xuexi.cn/points/exam-index.html')
```
<img src="/images/2022-3-19-学习强国积分自动化/答题界面.png" width="600" height="250"/>

可见有三种答题类型: 每日答题，每周答题，专项答题。

### 每日答题
进入每日答题页面
```
browser.get('https://pc.xuexi.cn/points/exam-practice.html')
```
发现共有三种题目类型: 单选题，多选题，填空题。

在每道题中，单击“查看提示”可以得到答案。从这时开始我们需要观察页面源码，确认各元素的xpath。下面以单选题为例详细说明。


首先按F12进入开发者工具。
[^note]:[百度百科介绍](https://baike.baidu.com/item/%E5%AD%A6%E4%B9%A0%E5%BC%BA%E5%9B%BD/23230796?fr=aladdin)
